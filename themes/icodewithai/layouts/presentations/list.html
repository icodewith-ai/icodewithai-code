{{ define "main" }}
    <main>
        <!-- Presentations Hero Section -->
        <section class="hero">
            <div class="container">
                <h1><span class="highlight">Presentations</span></h1>
                <p class="tagline">Live in-person and online presentations on how to build apps with AI.</p>
            </div>
        </section>

        <section class="section">
            <div class="container">
                
                {{ $upcomingPresentations := where .Pages ".Params.status" "upcoming" }}
                {{ $completedPresentations := where .Pages ".Params.status" "completed" }}
                
                {{ if $upcomingPresentations }}
                <h2>Upcoming</h2>
                <div class="blog-posts">
                    {{ range sort $upcomingPresentations ".Params.date_time" "asc" }}
                        <a href="{{ .Permalink }}" class="app-card-link">
                            <article class="app-card">
                                {{ if .Params.image }}
                                    {{ $presentationImg := resources.Get .Params.image }}
                                    {{ if $presentationImg }}
                                    <div class="presentation-card-thumbnail">
                                        {{ $presentationImgFingerprint := $presentationImg | resources.Fingerprint }}
                                        <img src="{{ $presentationImgFingerprint.RelPermalink }}" alt="{{ .Title }}" loading="lazy">
                                    </div>
                                    {{ end }}
                                {{ end }}
                                <h3>{{ .Title }}</h3>
                                {{ if .Params.presenter }}
                                    {{ $presenterKeys := split .Params.presenter "," }}
                                    {{ $presenterNames := slice }}
                                    {{ range $presenterKeys }}
                                        {{ $key := trim . " " }}
                                        {{ $presenterData := index $.Site.Data.people $key }}
                                        {{ if $presenterData }}
                                            {{ $presenterNames = $presenterNames | append $presenterData.fullName }}
                                        {{ end }}
                                    {{ end }}
                                    {{ if $presenterNames }}
                                        <div class="post-author">Presented by 
                                        {{ if eq (len $presenterNames) 1 }}
                                            {{ index $presenterNames 0 }}
                                        {{ else if eq (len $presenterNames) 2 }}
                                            {{ index $presenterNames 0 }} and {{ index $presenterNames 1 }}
                                        {{ else }}
                                            {{ $lastIndex := sub (len $presenterNames) 1 }}
                                            {{ range $i, $name := $presenterNames }}
                                                {{ if eq $i $lastIndex }}, and {{ $name }}{{ else if eq $i 0 }}{{ $name }}{{ else }}, {{ $name }}{{ end }}
                                            {{ end }}
                                        {{ end }}</div>
                                    {{ end }}
                                {{ end }}
                                <div class="app-meta">
                                    {{ dateFormat "January 2, 2006" .Params.date_time }} • {{ .Params.location }}{{ if .Params.meeting_type }} • {{ .Params.meeting_type | title }}{{ end }}
                                </div>
                                <p>{{ .Params.summary }}</p>
                                <span class="card-link">Learn more →</span>
                            </article>
                        </a>
                    {{ end }}
                </div>
                {{ end }}
                
                {{ if $completedPresentations }}
                <h2>Completed</h2>
                <div class="blog-posts">
                    {{ range sort $completedPresentations ".Params.date_time" "desc" }}
                        <a href="{{ .Permalink }}" class="app-card-link">
                            <article class="app-card">
                                {{ if .Params.image }}
                                    {{ $presentationImg := resources.Get .Params.image }}
                                    {{ if $presentationImg }}
                                    <div class="presentation-card-thumbnail">
                                        {{ $presentationImgFingerprint := $presentationImg | resources.Fingerprint }}
                                        <img src="{{ $presentationImgFingerprint.RelPermalink }}" alt="{{ .Title }}" loading="lazy">
                                    </div>
                                    {{ end }}
                                {{ end }}
                                <h3>{{ .Title }}</h3>
                                {{ if .Params.presenter }}
                                    {{ $presenterKeys := split .Params.presenter "," }}
                                    {{ $presenterNames := slice }}
                                    {{ range $presenterKeys }}
                                        {{ $key := trim . " " }}
                                        {{ $presenterData := index $.Site.Data.people $key }}
                                        {{ if $presenterData }}
                                            {{ $presenterNames = $presenterNames | append $presenterData.fullName }}
                                        {{ end }}
                                    {{ end }}
                                    {{ if $presenterNames }}
                                        <div class="post-author">Presented by 
                                        {{ if eq (len $presenterNames) 1 }}
                                            {{ index $presenterNames 0 }}
                                        {{ else if eq (len $presenterNames) 2 }}
                                            {{ index $presenterNames 0 }} and {{ index $presenterNames 1 }}
                                        {{ else }}
                                            {{ $lastIndex := sub (len $presenterNames) 1 }}
                                            {{ range $i, $name := $presenterNames }}
                                                {{ if eq $i $lastIndex }}, and {{ $name }}{{ else if eq $i 0 }}{{ $name }}{{ else }}, {{ $name }}{{ end }}
                                            {{ end }}
                                        {{ end }}</div>
                                    {{ end }}
                                {{ end }}
                                <div class="app-meta">
                                    {{ dateFormat "January 2, 2006" .Params.date_time }} • {{ .Params.location }}{{ if .Params.meeting_type }} • {{ .Params.meeting_type | title }}{{ end }}
                                </div>
                                <p>{{ .Params.summary }}</p>
                                <span class="card-link">Learn more →</span>
                            </article>
                        </a>
                    {{ end }}
                </div>
                {{ end }}
                
                {{ if and (eq (len $upcomingPresentations) 0) (eq (len $completedPresentations) 0) }}
                    <div class="app-card">
                        <h3>No presentations yet</h3>
                        <p>Check back soon for upcoming presentations!</p>
                    </div>
                {{ end }}
            </div>
        </section>
    </main>
{{ end }}